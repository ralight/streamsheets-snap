/********************************************************************************
 * Copyright (c) 2020 Cedalo AG
 *
 * This program and the accompanying materials are made available under the 
 * terms of the Eclipse Public License 2.0 which is available at
 * http://www.eclipse.org/legal/epl-2.0.
 *
 * SPDX-License-Identifier: EPL-2.0
 *
 ********************************************************************************/
'use strict';

const path = require('path');
const ImageHelper = require('../../src/helper/ImageHelper');

describe('ImageHelper', () => {
	describe('saveImage', () => {
		it('should save an image', (done) => {
			const targetPath = path.join(__dirname, '..', 'images', 'test');
			// eslint-disable-next-line
			const content = 'data:image/png;base64,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';
			const imagePath = path.join(targetPath, 'example.png');
			ImageHelper
				.saveImage({ content, imagePath })
				.then(() => {
					// console.info('Image saved');
					done();
				})
				.catch(() => {
					// console.error(error);
					done();
				});
		});
	});
});
